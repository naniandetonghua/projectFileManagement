# 后端Spring Boot项目结构说明

## 项目结构
```
project-delivery-backend/
├── src/
│   ├── main/
│   │   ├── java/
│   │   │   └── com/
│   │   │       └── projectdelivery/
│   │   │           ├── ProjectDeliveryApplication.java
│   │   │           ├── config/
│   │   │           │   ├── WebConfig.java
│   │   │           │   ├── SecurityConfig.java
│   │   │           │   └── FileUploadConfig.java
│   │   │           ├── controller/
│   │   │           │   ├── SystemController.java
│   │   │           │   ├── ProjectController.java
│   │   │           │   ├── DeliverableController.java
│   │   │           │   └── FileController.java
│   │   │           ├── service/
│   │   │           │   ├── SystemService.java
│   │   │           │   ├── ProjectService.java
│   │   │           │   ├── DeliverableService.java
│   │   │           │   └── FileService.java
│   │   │           ├── repository/
│   │   │           │   ├── SystemRepository.java
│   │   │           │   ├── ProjectRepository.java
│   │   │           │   ├── DeliverableRepository.java
│   │   │           │   └── DeliverableTypeRepository.java
│   │   │           ├── entity/
│   │   │           │   ├── System.java
│   │   │           │   ├── Project.java
│   │   │           │   ├── Deliverable.java
│   │   │           │   ├── DeliverableType.java
│   │   │           │   └── User.java
│   │   │           ├── dto/
│   │   │           │   ├── SystemDTO.java
│   │   │           │   ├── ProjectDTO.java
│   │   │           │   ├── DeliverableDTO.java
│   │   │           │   └── ApiResponse.java
│   │   │           ├── exception/
│   │   │           │   ├── GlobalExceptionHandler.java
│   │   │           │   └── BusinessException.java
│   │   │           └── util/
│   │   │               ├── FileUtil.java
│   │   │               └── DateUtil.java
│   │   └── resources/
│   │       ├── application.yml
│   │       ├── application-dev.yml
│   │       ├── application-prod.yml
│   │       └── static/
│   └── test/
│       └── java/
│           └── com/
│               └── projectdelivery/
│                   └── ProjectDeliveryApplicationTests.java
├── pom.xml
├── README.md
└── .gitignore
```

## 主要依赖配置 (pom.xml)
```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
         http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>2.7.0</version>
    </parent>

    <groupId>com.projectdelivery</groupId>
    <artifactId>project-delivery-backend</artifactId>
    <version>1.0.0</version>
    <name>project-delivery-backend</name>
    <description>项目交付物管理系统后端</description>

    <properties>
        <java.version>8</java.version>
        <mysql.version>8.0.28</mysql.version>
        <mybatis.version>2.2.2</mybatis.version>
    </properties>

    <dependencies>
        <!-- Spring Boot Starter Web -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>

        <!-- Spring Boot Starter Data JPA -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-jpa</artifactId>
        </dependency>

        <!-- Spring Boot Starter Security -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-security</artifactId>
        </dependency>

        <!-- MySQL Connector -->
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>${mysql.version}</version>
        </dependency>

        <!-- MyBatis Plus -->
        <dependency>
            <groupId>com.baomidou</groupId>
            <artifactId>mybatis-plus-boot-starter</artifactId>
            <version>${mybatis.version}</version>
        </dependency>

        <!-- Lombok -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <optional>true</optional>
        </dependency>

        <!-- Spring Boot Starter Validation -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-validation</artifactId>
        </dependency>

        <!-- Spring Boot Starter Test -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <configuration>
                    <excludes>
                        <exclude>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                        </exclude>
                    </excludes>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project>
```

## 配置文件 (application.yml)
```yaml
server:
  port: 8080
  servlet:
    context-path: /api

spring:
  profiles:
    active: dev
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/project_delivery_system?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai
    username: root
    password: password
  jpa:
    hibernate:
      ddl-auto: none
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQL8Dialect
        format_sql: true
  servlet:
    multipart:
      max-file-size: 100MB
      max-request-size: 100MB

mybatis-plus:
  configuration:
    map-underscore-to-camel-case: true
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  global-config:
    db-config:
      logic-delete-field: deleted
      logic-delete-value: 1
      logic-not-delete-value: 0

# 文件上传配置
file:
  upload:
    path: /opt/project-delivery/uploads/
    allowed-types: pdf,doc,docx,xls,xlsx,ppt,pptx,txt
    max-size: 104857600  # 100MB

# 日志配置
logging:
  level:
    com.projectdelivery: debug
  file:
    name: /opt/project-delivery/logs/application.log
```

## 核心功能模块

### 1. 系统管理模块
- 系统CRUD操作
- 系统状态管理

### 2. 项目管理模块
- 项目CRUD操作
- 项目类型管理（重大/普通）
- 项目状态跟踪

### 3. 交付物管理模块
- 交付物上传/下载
- 交付物状态管理
- 交付物类型配置

### 4. 文件管理模块
- 文件上传/下载
- 文件存储管理
- 文件权限控制

## API接口规范

### 统一响应格式
```json
{
  "code": 200,
  "message": "success",
  "data": {},
  "timestamp": "2024-01-01T12:00:00"
}
```

### 错误码定义
- 200: 成功
- 400: 请求参数错误
- 401: 未授权
- 403: 禁止访问
- 404: 资源不存在
- 500: 服务器内部错误

## 安全配置

### 1. 跨域配置
```java
@Configuration
public class WebConfig implements WebMvcConfigurer {
    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/**")
                .allowedOrigins("*")
                .allowedMethods("GET", "POST", "PUT", "DELETE", "OPTIONS")
                .allowedHeaders("*")
                .maxAge(3600);
    }
}
```

### 2. 文件上传安全
- 文件类型验证
- 文件大小限制
- 文件路径安全验证
- 病毒扫描（可选）

## 部署说明

### 1. 开发环境
```bash
# 启动应用
mvn spring-boot:run

# 打包
mvn clean package
```

### 2. 生产环境
```bash
# 启动应用
java -jar project-delivery-backend-1.0.0.jar --spring.profiles.active=prod
```

### 3. Docker部署
```dockerfile
FROM openjdk:8-jre-alpine
COPY target/project-delivery-backend-1.0.0.jar app.jar
EXPOSE 8080
ENTRYPOINT ["java", "-jar", "/app.jar"]
```

## 监控和日志

### 1. 健康检查
- 应用健康状态
- 数据库连接状态
- 文件系统状态

### 2. 日志管理
- 应用日志
- 访问日志
- 错误日志
- 文件操作日志

## 性能优化

### 1. 数据库优化
- 索引优化
- 查询优化
- 连接池配置

### 2. 文件处理优化
- 异步文件处理
- 文件压缩
- 缓存策略

### 3. 接口优化
- 分页查询
- 数据缓存
- 响应压缩 